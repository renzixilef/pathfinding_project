%********************************
\chapter{Programmaufbau und -struktur}
\label{ch:aufbau}
%********************************

%********************************
\section{Aufbau des Backends}
\label{sec:aufbau_backend}
%********************************
In diesem Abschnitt soll ein Überblick über den Aufbau und die Strukturierung des Backends gegeben werden.
`Backend' bezeichnet hierbei den ausführenden Teil des Programms, also Objekte und Strukturen die zur Berechnung/Lösung des Grids notwendig sind und keinen direkten User-Kontakt haben.

%********************************
\subsection{Überblick}
\label{subsec:aufbau_backend_ueberblick}
%********************************
Das Backend ist in zwei Namespaces unterteilt: `GridGenerator' und `Pathfinder'.
Ersterer beinhaltet jegliche Funktionalität die zur Erstellung der Grid-Objekte, zum Platzieren der Hindernisse und zur Positionierung des Start- und Endpunkts notwendig sind.
Der Namespace `Pathfinder' gruppiert Komponenten die zur Berechnung und Lösung ebendieser Objekte notwendig sind, sowie Funktionen zur Überwachung dieses Prozesses.
Im Folgenden soll zunächst auf die Erstellung der Grid-Objekte und sodann auf den Namespace `Pathfinder' eingegangen werden.
%********************************
\subsubsection{Namespace: GridGenerator}
\label{subsubsec:aufbau_backend_ueberblick_gridgen}
%********************************
Dieser Namespace setzt sich zusammen aus den Klassen \texttt{Cell}, \texttt{Grid} und \texttt{ObstacleGenerator}, sowie einigen Subklassen, unterstützenden Datenstrukturen und Enumerationen.
\begin{itemize}
    \item \textttt{Cell} \\
    \begin{figure}[H]
        \vspace{-0.5cm}
        \centering
        \includestandalone[width=0.7\textwidth]{assets/uml/cell_class_uml}
        \caption{UML-Klassendiagramm der Klasse \texttt{Cell}}
        \label{fig:uml_cell}
    \end{figure}
    Die \texttt{Cell}-Klasse hält Informationen und Funktionalität einer spezifischen Gridzelle.
    Jede Zelle hält ihre Kosten (\texttt{CellCost}) und einen Zustand (\texttt{CellState}: Hindernis, begehbar, etc.).
    Außerdem enthält die \texttt{Cell}-Klasse mehrere Helferfunktionen für die Interaktion mit den Gitterzellen.

    \item \textttt{Grid} \\
    \begin{figure}[H]
        \vspace{-0.5cm}
        \centering
        \includestandalone[width=0.7\textwidth]{assets/uml/grid_class_uml}
        \caption{UML-Klassendiagramm der Klasse \texttt{Grid}}
        \label{fig:uml_grid}
    \end{figure}
    Die \texttt{Grid}-Klasse hält Informationen und Funktionalität die Interaktionen mit dem Grid ermöglichen.
    Das tatsächliche Grid ist als \textttt{std::vector<std::vector<Cell>>} aufgebaut, der Zugrif findet über den \texttt{()}
    Operator und die Struktur \texttt{GridCoordinate} statt.
    Bei Instantiierung eines \texttt{Grid}-Objekts wird eine Referenz zu einem \texttt{ObstacleGenerator}-Objekt (ähnlich eines Decorator-Pattern)
    welchem die Verantwortung für die Hindernisgenerierung und das Festsetzen des Start- und Endpunkts übergeben wird.
    \newpage
    \item \textttt{ObstacleGenerator} \\
    \begin{figure}[H]
        \vspace{-0.5cm}
        \centering
        \includestandalone[width=0.7\textwidth]{assets/uml/obstacleGen_class_uml}
        \caption{UML-Klassendiagramm der Klasse \texttt{ObstacleGen}}
        \label{fig:uml_obstacle_gen}
    \end{figure}
    Die \texttt{ObstacleGen}-Klasse und ihre Subklassen sind nach einem Strategy-Pattern aufgebaut.
    Übergreifende Funktionalität der verschiedenen Algorithmen zur Erstellung der Hindernisse wird in der Elternklasse \texttt{ObstacleGen} gehalten.
    Zudem wird hier eine virtuelle Methode \texttt{generateObstacles()} definiert, die von den Subklassen mit dem jeweiligen Algorithmus überschrieben wird.
    Für den Kontext ist der tatsächliche Algorithmus dadurch irrelevant, es kann mit einem generischen Objekt vom Typ \texttt{ObstacleGen} gearbeitet werden.
    Zusätzlich wird in der gleichen Header-Datei ein \texttt{enum} und ein dazugehöriger Parser-\texttt{struct} für die verschiedenen Algorithmen definiert.
\end{itemize}
%********************************
\subsubsection{Namespace: Pathfinder}
\label{subsubsec:aufbau_backend_ueberblick_pathfinder}
%********************************
Der Namespace `Pathfinder' beeinhaltet die Klasse \texttt{PathfindingParent} und ihre Subklassen, sowie die Klasse \texttt{PathfinderTimer}.
Zusätzlich werden über diverse \texttt{structs} und \texttt{enums} Zustände und Interaktionen mit dem Frontend definiert.
\begin{itemize}
    \item \texttt{PathfindingParent}
    Die \texttt{PathfindingParent}-Klasse und ihre Subklassen sind ähnlich wie die \textttt{ObstacleGen}-Klasse nach einem Strategy-Pattern aufgebaut.
    In der Elternklasse wird ein generischer Pathfinder initialisiert, der konkrete Algorithmus ist auch hier vor dem Kontext verborgen.
    Der Instanz einer \texttt{PathinderParent}-Subklasse wird bei Konstruktion eine Referenz zu einem \texttt{Grid}-Objekt übergeben.
    Dieses Objekt repräsentiert den Handlungsrahmen des jeweiligen Pathfinding-Algorithmus.
    Über die virtuelle Methode \texttt{nextStep()} kann nach Initialisierung der nächste Schritt des jeweiligen Algorithmus durchgeführt werden.
    Zu Debugging-Zwecken wurde außerdem eine Methode \texttt{solveNoWait()} implementiert, die bis zum Ende des Lösungsprozesses
    iterativ die \texttt{nextStep()}-Methode aufruft.\\
    Für die diversen Subklassen wird auch hier noch ein zusätzlicher Parsing-\texttt{struct} und -\texttt{enum} für Interaktionen des Frontends definiert.
    \begin{figure}[H]
              \vspace{-0.5cm}
              \centering
              \includestandalone[width=0.7\textwidth]{assets/uml/pathfindingParent_class_uml}
              \caption{UML-Klassendiagramm der Klasse \texttt{PathfindingParent}}
              \label{fig:uml_pathfinder}
    \end{figure}
    \item \texttt{PathfinderTimer}
    \begin{figure}[H]
        \vspace{-0.5cm}
        \centering
        \includestandalone[width=0.7\textwidth]{assets/uml/pathfindingTimer_class_uml}
        \caption{UML-Klassendiagramm der Klasse \texttt{PathfinderTimer}}
        \label{fig:uml_pathfinder_timer}
    \end{figure}
    Die Klasse \texttt{PathfinderTimer} implementiert Metriken und Funktionalität zum rechenzeitbasierten Benchmarking der \texttt{PathfinderParent}-Subklasseninstanzen.
\end{itemize}